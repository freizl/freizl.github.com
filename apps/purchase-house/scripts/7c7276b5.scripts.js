"use strict";angular.module("purchaseHouseApp",["ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/help",{templateUrl:"views/help.html"}).otherwise({redirectTo:"/"})}]),function(a){function b(b,c,e){var f=0,g={};return a.forEach(["initPay","qiTax","yingYeTax","geTax"],function(a){if(g[a]=b*c[a]/100,"yingYeTax"===a&&d(c.overFiveYear,e)){var h=c.originalValue?c.originalValue:0;g.yingYeTax=c.yingYeTax*(b-h)/100}a.match(/Tax$/)&&(f+=g[a])}),g.middleManFee=c.price*c.middleManFee/100,g.diff=e?c.price-c.normalHouseValue:0,g.taxSubTotal=f,g.firstPayTotal=g.initPay+f+g.middleManFee+g.diff,g.load=b*(100-c.initPay)/100,g.total=g.firstPayTotal+g.load,g}function c(a,b){return!!a&&!!b}function d(a,b){return a&&!b}function e(a,b){var c=2;return a&&b?c=0:a&&!b&&(c=1),c}function f(a){a.input.geTax=e(a.input.overFiveYear,a.input.onlyOneHouse)}var g={1:{qiTax:1,initPay:30},2:{qiTax:3,initPay:70},3:{qiTax:3,initPay:100}};a.module("purchaseHouseApp").controller("MainCtrl",["$scope",function(d){d.result={},d.input={},d.input.middleManFee=2,d.input.yingYeTax=5.65,d.input.normalHouseValue=160,d.$watch("input.howManyHouses",function(){if(d.input&&d.input.howManyHouses){var a=g[""+d.input.howManyHouses];a||(a=g[3]),d.input.qiTax=a.qiTax,d.input.initPay=a.initPay}}),d.$watch("input.onlyOneHouse",function(){f(d)}),d.$watch("input.overFiveYear",function(){f(d)}),a.forEach(["input.price","input.initPay","input.qiTax","input.originalValue","input.yingYeTax","input.geTax","input.middleManFee","input.normalHouseValue","input.normalHouse"],function(e){d.$watch(e,function(){var e=a.copy(d.input);e&&e.price&&(d.result=b(e.price,e,!1),e.normalHouse&&(e.geTax=e.geTax>0?1:0,e.yingYeTax=c(e.overFiveYear,e.normalHouse)?0:5.65,d.cheating=b(e.normalHouseValue,e,e.normalHouse)))})}),d.cal=function(){var a={},b=d.price,c=0;a.price=b,a.subTotal=c}}])}(angular),angular.module("purchaseHouseApp").filter("naValue",function(){return function(a){return a?a.toFixed(2):"-"}});