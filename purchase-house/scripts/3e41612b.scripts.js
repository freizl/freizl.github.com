"use strict";angular.module("purchaseHouseApp",["ngRoute"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/help",{templateUrl:"views/help.html"}).otherwise({redirectTo:"/"})}]),function(a){function b(b,c,e){var f=0,g={};if(a.forEach(["initPay","qiTax","yingYeTax","geTax"],function(a){g[a]=b*c[a]/100,a.match(/Tax$/)&&(f+=g[a])}),d(c.overFiveYear,c.normalHouse)){var h=c.originalValue?c.originalValue:0;g.yingYeTax=c.yingYeTax*(b-h)/100}return g.middleManFee=c.price*c.middleManFee/100,g.diff=e?c.price-c.normalHouseValue:0,g.taxSubTotal=f,g.firstPayTotal=g.initPay+f+g.middleManFee+g.diff,g.load=b*(100-c.initPay)/100,g.total=g.firstPayTotal+g.load,g}function c(a,b){return!!a&&!!b}function d(a,b){return a&&!b}var e={1:{qiTax:1,initPay:30},2:{qiTax:3,initPay:70},3:{qiTax:3,initPay:100}};a.module("purchaseHouseApp").controller("MainCtrl",["$scope",function(f){f.result={},f.input={},f.input.middleManFee=2,f.input.yingYeTax=5.65,f.input.normalHouseValue=160,f.needShowOriginalValue=function(){var a=f.input;return d(a.overFiveYear,a.normalHouse)},f.$watch("input.howManyHouses",function(){if(f.input&&f.input.howManyHouses){var a=e[""+f.input.howManyHouses];!!a||(a=e[3]),f.input.qiTax=a.qiTax,f.input.initPay=a.initPay}}),f.$watch("input.onlyOneHouse",function(){f.input.geTax=f.input.onlyOneHouse?0:2}),a.forEach(["input.price","input.initPay","input.qiTax","input.originalValue","input.yingYeTax","input.geTax","input.middleManFee","input.normalHouse","input.overFiveYear"],function(d){f.$watch(d,function(){var d=a.copy(f.input);d&&d.price&&(f.input.yingYeTax=d.yingYeTax=c(d.overFiveYear,d.normalHouse)?0:5.65,console.log(c(d.overFiveYear,d.normalHouse)),f.result=b(d.price,d),d.normalHouse&&(d.geTax=d.geTax>0?1:0,f.cheating=b(d.normalHouseValue,d,d.normalHouse)))})}),f.cal=function(){var a={},b=f.price,c=0;a.price=b,a.subTotal=c,console.log(a)}}])}(angular),angular.module("purchaseHouseApp").filter("naValue",function(){return function(a){return a?a.toFixed(2):"-"}});