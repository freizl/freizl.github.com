<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<style type=text/css>body{font-family:monospace}</style>
<title>MapM</title>
<link rel=stylesheet href=../../css/style.css>
</head>
<body>
<header>
=================<br>
== <a href=https://freizl.github.io/>Corner case</a> ==<br>
=================
<div style=float:right>Welcome to my new blog!</div><br>
<p>
<nav>
<a href=../../><b>Start</b></a>.
</header>
<main>
<article>
<h1>MapM</h1>
<b><time>06/14/2011</time></b>
<a href=../../tags/monad>monad</a>
<a href=../../tags/haskell>haskell</a>
<div>
<h2 id=how-to-understand-the-following-computation-result>How to understand the following computation result?</h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell>  <span style=color:#66d9ef>Prelude</span><span style=color:#f92672>&gt;</span> mapM id [<span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>1</span>, <span style=color:#66d9ef>Nothing</span>, <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>3</span>]
  <span style=color:#66d9ef>Nothing</span>
</code></pre></div><h2 id=reason-about>&lsquo;Reason about&rsquo;</h2>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell>  mapM     <span style=color:#f92672>::</span> (a <span style=color:#f92672>-&gt;</span> m b) <span style=color:#f92672>-&gt;</span> [a] <span style=color:#f92672>-&gt;</span> m [b]
  id       <span style=color:#f92672>::</span> a <span style=color:#f92672>-&gt;</span> a
  sequence <span style=color:#f92672>::</span> (<span style=color:#66d9ef>Monad</span> m) <span style=color:#f92672>=&gt;</span> [m a] <span style=color:#f92672>-&gt;</span> m [a]
</code></pre></div><p>Therefore,</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell>  <span style=color:#f92672>&gt;</span> a <span style=color:#f92672>=</span> <span style=color:#66d9ef>Maybe</span> <span style=color:#66d9ef>Int</span>
  <span style=color:#f92672>&gt;</span> m <span style=color:#f92672>=</span> <span style=color:#66d9ef>Maybe</span>
  <span style=color:#f92672>&gt;</span> b <span style=color:#f92672>=</span> <span style=color:#66d9ef>Int</span>
</code></pre></div><p>the mapM and sequence is implemented like this:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell>  mapM f xs <span style=color:#f92672>=</span> sequence (map f xs)

  sequence (c<span style=color:#66d9ef>:</span>cs) <span style=color:#f92672>=</span> <span style=color:#66d9ef>do</span> x  <span style=color:#f92672>&lt;-</span> c
                       xs <span style=color:#f92672>&lt;-</span> sequence cs
                    return (x<span style=color:#66d9ef>:</span>xs)
</code></pre></div><p>Hence the result could be understood in such way</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell>    mapM id [<span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>1</span>, <span style=color:#66d9ef>Nothing</span>, <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>3</span>]
  <span style=color:#f92672>=</span> sequence (map id [<span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>1</span>, <span style=color:#66d9ef>Nothing</span>, <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>3</span>])
  <span style=color:#f92672>=</span> sequence [<span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>1</span>, <span style=color:#66d9ef>Nothing</span>, <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>3</span>]
  <span style=color:#f92672>=</span> <span style=color:#66d9ef>do</span> { x <span style=color:#f92672>&lt;-</span> <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>1</span>; xs <span style=color:#f92672>&lt;-</span> sequence [<span style=color:#66d9ef>Nothing</span>, <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>3</span>]; return (x<span style=color:#66d9ef>:</span>xs) }
  <span style=color:#f92672>=</span> <span style=color:#f92672>...</span>
  <span style=color:#f92672>=</span> <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>1</span> <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#a6e22e>\</span>x <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>Nothing</span> <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#a6e22e>\</span>y <span style=color:#f92672>-&gt;</span> <span style=color:#66d9ef>Just</span> <span style=color:#ae81ff>3</span> <span style=color:#f92672>&gt;&gt;=</span> <span style=color:#a6e22e>\</span>z <span style=color:#f92672>-&gt;</span> return (x<span style=color:#66d9ef>:</span>y<span style=color:#66d9ef>:</span>z)
  <span style=color:#f92672>=</span> <span style=color:#66d9ef>Nothing</span>          <span style=color:#75715e>-- Because Nothing &gt;&gt;= ... produce Nothing</span>
</code></pre></div>
</div>
</article>
</main>
<aside>
<div>
<div>
<h3>LATEST POSTS</h3>
</div>
<div>
<ul>
<li><a href=../../posts/hello-hugo/>Hello Hugo</a></li>
<li><a href=../../posts/notes-sf-bay-area-must-do-hiking/>Notes Sf Bay Area Must Do Hiking</a></li>
<li><a href=../../posts/improve-space-usage/>Improve Space Usage</a></li>
<li><a href=../../posts/snaplet-request-local-state/>Snaplet Request Local State</a></li>
<li><a href=../../posts/chinese-tag-in-hakyll/>Chinese Tag In Hakyll</a></li>
</ul>
</div>
</div>
</aside>
<footer>
<p>&copy; 2021 <a href=https://freizl.github.io/><b>Haisheng Wu</b></a>.
</p>
</footer>
</body>
</html>