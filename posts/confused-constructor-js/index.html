<!doctype html><html lang=en-us>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1">
<meta http-equiv=x-ua-compatible content="IE=edge">
<style type=text/css>body{font-family:monospace}</style>
<title>Confused Constructor Js</title>
<link rel=stylesheet href=../../css/style.css>
</head>
<body>
<header>
=================<br>
== <a href=https://freizl.github.io/>Corner case</a> ==<br>
=================
<div style=float:right>Welcome to my new blog!</div><br>
<p>
<nav>
<a href=../../><b>Start</b></a>.
</header>
<main>
<article>
<h1>Confused Constructor Js</h1>
<b><time>04/12/2012</time></b>
<a href=../../tags/javascripts>javascripts</a>
<div>
<h2 id=introduction>Introduction</h2>
<p>I can not quite remember what happened when invoking <code>new</code> over a
function. While I&rsquo;m looking at function <code>init</code> at jQuery source, the
concern comes to me again.</p>
<p>Fourtunaly I think the answer at this<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> thread turns out to be a
quite clear explanation.</p>
<p>Just three things according to that answer.</p>
<ol>
<li>Creates a new object. Its type is <code>object</code>.</li>
<li>Sets this new object&rsquo;s internal, inaccessible, <code>[[prototype]]</code>
property to be the constructor function&rsquo;s external, accessible,
<code>prototype</code> object. <em>Refer to line 11 at <a href=#sample>sample</a></em>.</li>
<li>Executes the constructor function, using the new object whenever
<code>this</code> is mentioned.</li>
</ol>
<p>Regarding #2, we might have question like</p>
<ol>
<li>What is constuctor function&rsquo;s <code>prototype</code> object?</li>
<li>What is the <code>[[prototype]]</code>?</li>
</ol>
<p>The answer are</p>
<ol>
<li>Function&rsquo;s <code>prototype</code> property is automatically created which in
turn has a constructor property pointing back to the function. <em>Refer
to line 4 at <a href=#sample>sample</a></em></li>
<li>Basically <code>[[prototype]]</code> is used for prototype chain. Find details
at here<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> and Ecma-262<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</li>
</ol>
<p>Therefore if we change the <code>prototype</code> property of the function before
<code>new</code>, the <code>[[prototype]]</code> of instances afterwards is vary accordingly.
<em>Refer to line 19 at <a href=#sample>sample</a></em></p>
<h2 id=sample>Sample</h2>
<ul>
<li><strong>tested at google chrome 18 and pay close attention to comments.</strong></li>
</ul>
<ul>
<li>Quiz: Why y1.constructor is not same as x1.constructor?</li>
</ul>
<h2 id=jquery.fn.init>JQuery.fn.init</h2>
<ul>
<li><code>jQuery</code> is declarated as</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>  var jQuery = function( selector, context ) {
          // The jQuery object is actually just the init constructor &#39;enhanced&#39;
          return new jQuery.fn.init( selector, context, rootjQuery );
      },
</code></pre></div><ul>
<li><code>jQuery.fn</code> is just a object as</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>  jQuery.fn = {
      constructor: jQuery,
      init: function( selector, context, rootjQuery ) {
              var match, elem, ret, doc;
              ... ...
            },
      ... ... // many API declaration.
  }
</code></pre></div><ul>
<li>Function chain</li>
</ul>
<p>Since <code>jQuery</code> is just a function, we are able to do with a selector
like <code>jQuery('div.navigator').addClass('nav')</code>.</p>
<p>Actually in order to use jQuery API like <code>addClass</code>, there must exists
following something which of cource can be found at around line 322 of
jQuery.1.7.1.css<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text>  jQuery.fn.init.prototype = jQuery.fn;
</code></pre></div><section class=footnotes role=doc-endnotes>
<hr>
<ol>
<li id=fn:1 role=doc-endnote>
<p><a href=http://stackoverflow.com/questions/1646698/what-is-the-new-keyword-in-javascript>What is new keyword in JS</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:2 role=doc-endnote>
<p><a href=http://joost.zeekat.nl/constructors-considered-mildly-confusing.html>Constructors considered confusing</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:3 role=doc-endnote>
<p><a href=http://www.ecma-international.org/publications/standards/Ecma-262.htm>Ecma262</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
<li id=fn:4 role=doc-endnote>
<p><a href=http://code.jquery.com/jquery-1.7.2.js>jQuery 1.7.1</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p>
</li>
</ol>
</section>
</div>
</article>
</main>
<aside>
<div>
<div>
<h3>LATEST POSTS</h3>
</div>
<div>
<ul>
<li><a href=../../posts/hello-hugo/>Hello Hugo</a></li>
<li><a href=../../posts/improve-space-usage/>Improve Space Usage</a></li>
<li><a href=../../posts/snaplet-request-local-state/>Snaplet Request Local State</a></li>
<li><a href=../../posts/chinese-tag-in-hakyll/>Chinese Tag In Hakyll</a></li>
<li><a href=../../posts/confused-constructor-js/>Confused Constructor Js</a></li>
</ul>
</div>
</div>
</aside>
<footer>
<p>&copy; 2021 <a href=https://freizl.github.io/><b>Haisheng Wu</b></a>.
</p>
</footer>
</body>
</html>