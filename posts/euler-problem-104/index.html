<!doctype html><html lang=en-us><head><link rel=preload href=../../lib/font-awesome/webfonts/fa-brands-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=../../lib/font-awesome/webfonts/fa-regular-400.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=../../lib/font-awesome/webfonts/fa-solid-900.woff2 as=font type=font/woff2 crossorigin=anonymous><link rel=preload href=../../lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2 as=font type=font/woff2 crossorigin=anonymous><script type=text/javascript src=https://latest.cactus.chat/cactus.js></script>
<link rel=stylesheet href=https://latest.cactus.chat/style.css type=text/css><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><title>Euler Problem 104 | Corner case</title><link rel=canonical href=https://freizl.github.io/posts/euler-problem-104/><meta name=description content="Welcome to my personal blog."><meta name=viewport content="width=device-width,initial-scale=1"><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta property="og:title" content="Euler Problem 104"><meta property="og:description" content="Solutions There are two solutions below. One is written by me and another from haskell wiki.
They look quite similar and I can not figure out why the wiki solution can solve problem but not mine. (Actually mine take more than 15 minutes)
 My Solution   main = print $ snd $ head $  dropWhile (\ (x,y) -> (not . isLastNinePandigit &#34;123456789&#34;) x)  (zip fibs [1..])   bothNinePandigit digits n = isFirstNinePandigit digits n  && isLastNinePandigit digits n   isLastNinePandigit digits = (== digits) ."><meta property="og:type" content="article"><meta property="og:url" content="https://freizl.github.io/posts/euler-problem-104/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2011-12-15T00:00:00+00:00"><meta property="article:modified_time" content="2011-12-15T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Euler Problem 104"><meta name=twitter:description content="Solutions There are two solutions below. One is written by me and another from haskell wiki.
They look quite similar and I can not figure out why the wiki solution can solve problem but not mine. (Actually mine take more than 15 minutes)
 My Solution   main = print $ snd $ head $  dropWhile (\ (x,y) -> (not . isLastNinePandigit &#34;123456789&#34;) x)  (zip fibs [1..])   bothNinePandigit digits n = isFirstNinePandigit digits n  && isLastNinePandigit digits n   isLastNinePandigit digits = (== digits) ."><link rel=stylesheet href=https://freizl.github.io/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script>
<script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel=icon type=image/png href=https://freizl.github.io/images/favicon.ico><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,o,i,a,t,n,s){e.GoogleAnalyticsObject=t,e[t]=e[t]||function(){(e[t].q=e[t].q||[]).push(arguments)},e[t].l=1*new Date,n=o.createElement(i),s=o.getElementsByTagName(i)[0],n.async=1,n.src=a,s.parentNode.insertBefore(n,s)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-6496210-5","auto"),ga("send","pageview"))</script></head><body class="max-width mx-auto px3 ltr"><div class="content index py4"><div id=header-post><a id=menu-icon href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=menu-icon-tablet href=#><i class="fas fa-bars fa-lg"></i></a>
<a id=top-icon-tablet href=# onclick='$("html, body").animate({scrollTop:0},"fast")' style=display:none aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
<span id=menu><span id=nav><ul></ul></span><br><span id=actions><ul><li><a class=icon href=https://freizl.github.io/posts/euler-problem-14/ aria-label=Previous><i class="fas fa-chevron-left" aria-hidden=true onmouseover='$("#i-prev").toggle()' onmouseout='$("#i-prev").toggle()'></i></a></li><li><a class=icon href=https://freizl.github.io/posts/shell-tips/ aria-label=Next><i class="fas fa-chevron-right" aria-hidden=true onmouseover='$("#i-next").toggle()' onmouseout='$("#i-next").toggle()'></i></a></li><li><a class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up" aria-hidden=true onmouseover='$("#i-top").toggle()' onmouseout='$("#i-top").toggle()'></i></a></li><li><a class=icon href=# aria-label=Share><i class="fas fa-share-alt" aria-hidden=true onmouseover='$("#i-share").toggle()' onmouseout='$("#i-share").toggle()' onclick='return $("#share").toggle(),!1'></i></a></li></ul><span id=i-prev class=info style=display:none>Previous post</span>
<span id=i-next class=info style=display:none>Next post</span>
<span id=i-top class=info style=display:none>Back to top</span>
<span id=i-share class=info style=display:none>Share post</span></span><br><div id=share style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f" aria-label=Facebook><i class="fab fa-facebook" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&text=Euler%20Problem%20104" aria-label=Twitter><i class="fab fa-twitter" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&title=Euler%20Problem%20104" aria-label=Linkedin><i class="fab fa-linkedin" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&is_video=false&description=Euler%20Problem%20104" aria-label=Pinterest><i class="fab fa-pinterest" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Euler%20Problem%20104&body=Check out this article: https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f" aria-label=Email><i class="fas fa-envelope" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&title=Euler%20Problem%20104" aria-label=Pocket><i class="fab fa-get-pocket" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&title=Euler%20Problem%20104" aria-label=reddit><i class="fab fa-reddit" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&name=Euler%20Problem%20104&description=Solutions%20There%20are%20two%20solutions%20below.%20One%20is%20written%20by%20me%20and%20another%20from%20haskell%20wiki.%0aThey%20look%20quite%20similar%20and%20I%20can%20not%20figure%20out%20why%20the%20wiki%20solution%20can%20solve%20problem%20but%20not%20mine.%20%28Actually%20mine%20take%20more%20than%2015%20minutes%29%0a%20My%20Solution%20%20%20main%20%3d%20print%20%24%20snd%20%24%20head%20%24%20%20dropWhile%20%28%5c%20%28x%2cy%29%20-%26gt%3b%20%28not%20.%20isLastNinePandigit%20%26%2334%3b123456789%26%2334%3b%29%20x%29%20%20%28zip%20fibs%20%5b1..%5d%29%20%20%20bothNinePandigit%20digits%20n%20%3d%20isFirstNinePandigit%20digits%20n%20%20%26amp%3b%26amp%3b%20isLastNinePandigit%20digits%20n%20%20%20isLastNinePandigit%20digits%20%3d%20%28%3d%3d%20digits%29%20." aria-label=Tumblr><i class="fab fa-tumblr" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&t=Euler%20Problem%20104" aria-label="Hacker News"><i class="fab fa-hacker-news" aria-hidden=true></i></a></li></ul></div><div id=toc><nav id=TableOfContents><ul><li><a href=#solutions>Solutions</a></li><li><a href=#why-the-differences>Why the differences?</a></li><li><a href=#profiling>Profiling</a></li><li><a href=#further>Further</a></li></ul></nav></div></span></div><article class=post itemscope itemtype=http://schema.org/BlogPosting><header><h1 class=posttitle itemprop="name headline">Euler Problem 104</h1><div class=meta><div class=postdate><time datetime="2011-12-15 00:00:00 +0000 UTC" itemprop=datePublished>2011-12-15</time></div><div class=article-tag><i class="fas fa-tag"></i>
<a class=tag-link href=../../tags/euler rel=tag>euler</a>
,
<a class=tag-link href=../../tags/haskell rel=tag>haskell</a></div></div></header><div class=content itemprop=articleBody><h2 id=solutions>Solutions</h2><p>There are two solutions below. One is written by me and another from
haskell wiki.</p><p>They look quite similar and I can not figure out why the wiki solution
can solve problem but not mine. (Actually mine take more than 15
minutes)</p><ul><li>My Solution</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell><span style=display:flex><span>  main <span style=color:#f92672>=</span> print <span style=color:#f92672>$</span> snd <span style=color:#f92672>$</span> head <span style=color:#f92672>$</span>
</span></span><span style=display:flex><span>         dropWhile (<span style=color:#a6e22e>\</span> (x,y) <span style=color:#f92672>-&gt;</span> (not <span style=color:#f92672>.</span> isLastNinePandigit <span style=color:#e6db74>&#34;123456789&#34;</span>) x)
</span></span><span style=display:flex><span>                   (zip fibs [<span style=color:#ae81ff>1</span><span style=color:#f92672>..</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  bothNinePandigit digits n <span style=color:#f92672>=</span>  isFirstNinePandigit digits n
</span></span><span style=display:flex><span>                               <span style=color:#f92672>&amp;&amp;</span> isLastNinePandigit digits n
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  isLastNinePandigit  digits <span style=color:#f92672>=</span> (<span style=color:#f92672>==</span> digits) <span style=color:#f92672>.</span> sort <span style=color:#f92672>.</span> lastDigits <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>  isFirstNinePandigit digits <span style=color:#f92672>=</span> (<span style=color:#f92672>==</span> digits) <span style=color:#f92672>.</span> sort <span style=color:#f92672>.</span> firstDigits <span style=color:#ae81ff>9</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  firstDigits k n <span style=color:#f92672>=</span> take k (show n)
</span></span><span style=display:flex><span>  lastDigits  k n <span style=color:#f92672>=</span> show (n `mod` <span style=color:#ae81ff>10</span><span style=color:#f92672>^</span>k)
</span></span></code></pre></div><ul><li>Haskell Wiki solution<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell><span style=display:flex><span>
</span></span><span style=display:flex><span>  fibs <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>:</span> <span style=color:#ae81ff>1</span> <span style=color:#66d9ef>:</span> zipWith (<span style=color:#f92672>+</span>) fibs (tail fibs)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  isFibPan n <span style=color:#f92672>=</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>let</span> a <span style=color:#f92672>=</span> n `mod` <span style=color:#ae81ff>1000000000</span>
</span></span><span style=display:flex><span>        b <span style=color:#f92672>=</span> sort (show a)
</span></span><span style=display:flex><span>        c <span style=color:#f92672>=</span> sort <span style=color:#f92672>$</span> take <span style=color:#ae81ff>9</span> <span style=color:#f92672>$</span> show n
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>in</span>  b <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;123456789&#34;</span> <span style=color:#f92672>&amp;&amp;</span> c <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;123456789&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  ex_104 <span style=color:#f92672>=</span> snd <span style=color:#f92672>$</span> head <span style=color:#f92672>$</span>
</span></span><span style=display:flex><span>           dropWhile (<span style=color:#a6e22e>\</span>(x,y) <span style=color:#f92672>-&gt;</span> (not <span style=color:#f92672>.</span> isFibPan) x) (zip fibs [<span style=color:#ae81ff>1</span><span style=color:#f92672>..</span>])
</span></span></code></pre></div><h2 id=why-the-differences>Why the differences?</h2><p>The key point here is should test start nine digits first or test end
nine digits.</p><p>Two concerns here:</p><ol><li><code>show</code> function is (relatively) slow which used in test first 9
digits function.</li><li>quite few numbers are end in digits 1..9 in the first 329000 numbers</li></ol><p>Therefore test last 9 digits first make great performance improvement.</p><p><em>Thanks Brent<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> explanation this sneaky thing very comprehensively
in haskell-beginner.</em></p><h2 id=profiling>Profiling</h2><p>What help to identify is the GHC profiling tool.</p><p>Several options used here are</p><ul><li><p><strong>prof</strong>: for basic time and allocation profiling</p></li><li><p><strong>auto-all</strong>: auto insert cost centers on all top level functions. &ldquo;cost
center&rdquo; is a location in the program like to collect statistics about
and GHC will generate code to compute the cost of evalutating the
expression at each location. e.g.</p></li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell><span style=display:flex><span>    mean  s <span style=color:#f92672>=</span> <span style=color:#75715e>{-# SCC &#34;mean&#34; #-}</span> sum  s <span style=color:#f92672>/</span> fromIntegral (length s)
</span></span></code></pre></div><ul><li><p><strong>caf-all</strong>: function with no parameters only computed once. CAF means
constant applicative forms which used for calculate that once time
evaluation.</p></li><li><p><strong>fforce-recomp</strong>: force full recompilation.</p></li></ul><p>More details could go to chapter 25<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup> of [Real World Haskell] and
GHC user guider chapter 5<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-haskell data-lang=haskell><span style=display:flex><span>  <span style=color:#f92672>#</span> build with prof option on
</span></span><span style=display:flex><span>  ghc <span style=color:#75715e>--make -O2 -prof -auto-all -rtsopts p104.hs</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>#</span> <span style=color:#66d9ef>then</span> run
</span></span><span style=display:flex><span>  <span style=color:#f92672>./</span>p104 <span style=color:#f92672>+</span><span style=color:#66d9ef>RTS</span> <span style=color:#f92672>-</span>p <span style=color:#f92672>-</span><span style=color:#66d9ef>RTS</span>
</span></span></code></pre></div><h2 id=further>Further</h2><ol><li>Chapter 25 in Real Work Haskell about profile</li></ol><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=http://www.haskell.org/haskellwiki/Euler%5Fproblems/100%5Fto%5F110>Haskell Wiki Euler Problem</a>&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p><a href=http://comments.gmane.org/gmane.comp.lang.haskell.beginners/9175>Haskell Beginner 9175</a>&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p><a href=http://book.realworldhaskell.org/read/profiling-and-optimization.html>Profiling and optimization</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p><a href=http://www.haskell.org/ghc/docs/latest/html/users%5Fguide/profiling.html>GHC User Guider</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div></article><div id=footer-post-container><div id=footer-post><div id=nav-footer style=display:none><ul></ul></div><div id=toc-footer style=display:none><nav id=TableOfContents><ul><li><a href=#solutions>Solutions</a></li><li><a href=#why-the-differences>Why the differences?</a></li><li><a href=#profiling>Profiling</a></li><li><a href=#further>Further</a></li></ul></nav></div><div id=share-footer style=display:none><ul><li><a class=icon href="http://www.facebook.com/sharer.php?u=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f" aria-label=Facebook><i class="fab fa-facebook fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://twitter.com/share?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&text=Euler%20Problem%20104" aria-label=Twitter><i class="fab fa-twitter fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.linkedin.com/shareArticle?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&title=Euler%20Problem%20104" aria-label=Linkedin><i class="fab fa-linkedin fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://pinterest.com/pin/create/bookmarklet/?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&is_video=false&description=Euler%20Problem%20104" aria-label=Pinterest><i class="fab fa-pinterest fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="mailto:?subject=Euler%20Problem%20104&body=Check out this article: https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f" aria-label=Email><i class="fas fa-envelope fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://getpocket.com/save?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&title=Euler%20Problem%20104" aria-label=Pocket><i class="fab fa-get-pocket fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://reddit.com/submit?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&title=Euler%20Problem%20104" aria-label=reddit><i class="fab fa-reddit fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="http://www.tumblr.com/share/link?url=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&name=Euler%20Problem%20104&description=Solutions%20There%20are%20two%20solutions%20below.%20One%20is%20written%20by%20me%20and%20another%20from%20haskell%20wiki.%0aThey%20look%20quite%20similar%20and%20I%20can%20not%20figure%20out%20why%20the%20wiki%20solution%20can%20solve%20problem%20but%20not%20mine.%20%28Actually%20mine%20take%20more%20than%2015%20minutes%29%0a%20My%20Solution%20%20%20main%20%3d%20print%20%24%20snd%20%24%20head%20%24%20%20dropWhile%20%28%5c%20%28x%2cy%29%20-%26gt%3b%20%28not%20.%20isLastNinePandigit%20%26%2334%3b123456789%26%2334%3b%29%20x%29%20%20%28zip%20fibs%20%5b1..%5d%29%20%20%20bothNinePandigit%20digits%20n%20%3d%20isFirstNinePandigit%20digits%20n%20%20%26amp%3b%26amp%3b%20isLastNinePandigit%20digits%20n%20%20%20isLastNinePandigit%20digits%20%3d%20%28%3d%3d%20digits%29%20." aria-label=Tumblr><i class="fab fa-tumblr fa-lg" aria-hidden=true></i></a></li><li><a class=icon href="https://news.ycombinator.com/submitlink?u=https%3a%2f%2ffreizl.github.io%2fposts%2feuler-problem-104%2f&t=Euler%20Problem%20104" aria-label="Hacker News"><i class="fab fa-hacker-news fa-lg" aria-hidden=true></i></a></li></ul></div><div id=actions-footer><a id=menu-toggle class=icon href=# onclick='return $("#nav-footer").toggle(),!1' aria-label=Menu><i class="fas fa-bars fa-lg" aria-hidden=true></i> Menu</a>
<a id=toc-toggle class=icon href=# onclick='return $("#toc-footer").toggle(),!1' aria-label=TOC><i class="fas fa-list fa-lg" aria-hidden=true></i> TOC</a>
<a id=share-toggle class=icon href=# onclick='return $("#share-footer").toggle(),!1' aria-label=Share><i class="fas fa-share-alt fa-lg" aria-hidden=true></i> share</a>
<a id=top style=display:none class=icon href=# onclick='$("html, body").animate({scrollTop:0},"fast")' aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg" aria-hidden=true></i> Top</a></div></div></div><footer id=footer><div class=footer-left>Copyright &copy; 2022 Haisheng Wu</div><div class=footer-right><nav><ul></ul></nav></div></footer></div></body><link rel=stylesheet href=../../lib/font-awesome/css/all.min.css><script src=../../lib/jquery/jquery.min.js></script>
<script src=../../js/main.js></script>
<script src=../../js/code-copy.js></script></html>